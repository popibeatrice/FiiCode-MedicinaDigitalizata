(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var o in r)e.o(r,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:r[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=require("firebase/app"),r=require("firebase/storage"),o=require("firebase/firestore"),n=require("firebase/auth");var a=(0,t.initializeApp)({apiKey:"AIzaSyD00DDmckXiMglWRxEnhLBlQLovoLzfE-0",authDomain:"menumed-cc109.firebaseapp.com",projectId:"menumed-cc109",storageBucket:"menumed-cc109.appspot.com",messagingSenderId:"772753359565",appId:"1:772753359565:web:af2e60a2297359bbc0df84"}),i=(0,n.getAuth)();(0,n.setPersistence)(i,n.browserSessionPersistence);var l=(0,o.getFirestore)(a);(0,r.getStorage)(a);const s=require("intl-tel-input");var c=e.n(s);const u=document.querySelector("#phoneNumber");var d,m=c()(u,{utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/utils.min.js",initialCountry:"ro",formatOnDisplay:!0});const p=document.querySelector("#formix"),v=document.querySelector("main");p.addEventListener("submit",(e=>{e.preventDefault(),m.isValidNumber()?async function(e){if((await(0,o.getDocs)(e)).empty)throw TypeError("nu esti smecher")}((0,o.query)((0,o.collection)(l,"invited_users"),(0,o.where)((0,o.documentId)(),"==",m.getNumber()))).then((()=>{var e;d=m.getNumber(),e=m.getNumber(),window.appVerifier=new n.RecaptchaVerifier("recaptcha-container",{size:"invisible"},i),(0,n.signInWithPhoneNumber)(i,e,window.appVerifier).then((function(e){var t=prompt("Please enter the verification code sent to your mobile phone:");return e.confirm(t)})).then((function(e){const t=document.querySelector("#vrajeala"),r=document.querySelector("#formux"),a=document.querySelector("#pass"),s=document.querySelector("#passconf"),c=document.querySelector(".password-regex"),u=/^(.{0,7}|[^a-z]{1,}|[^A-Z]{1,}|[^\d]{1,})$|[\s]/;v.classList.remove("flex"),v.classList.add("hidden"),t.classList.remove("hidden"),t.classList.add("flex"),a.addEventListener("keyup",(()=>{""===a.value?(a.style.borderBottomColor="#293241",c.style.color="rgb(75 85 99 / var(--tw-text-opacity))"):!0===u.test(a.value)?(a.style.borderBottomColor="red",c.style.color="red"):!1===u.test(a.value)&&(a.style.borderBottomColor="lightgreen",c.style.color="lightgreen"),""===a.value||""===s.value?s.style.borderBottomColor="#293241":s.value!==a.value?s.style.borderBottomColor="red":s.value===a.value&&(s.style.borderBottomColor="lightgreen")})),s.addEventListener("keyup",(()=>{""===s.value||""===a.value?s.style.borderBottomColor="#293241":s.value!==a.value?s.style.borderBottomColor="red":s.value===a.value&&(s.style.borderBottomColor="lightgreen")})),r.addEventListener("submit",(e=>{e.preventDefault();const t=r.email.value,a=r.pass.value,c=r.nume.value,m=r.prenume.value;if(""===t||""===a||""===c||""===m)return void alert("completati campurile");if(!0===u.test(a))return void alert("parola nu e safe");if(a!==s.value)return void alert("nu e buna confirmarea parolei");const p=n.EmailAuthProvider.credential(t,a);(0,n.linkWithCredential)(i.currentUser,p).then((e=>{const t=i.currentUser.uid;(async function(e){const t=await(0,o.getDoc)(e);if(t.exists())return t.data().medic;throw TypeError("nu esti docos")})((0,o.doc)(l,"invited_users",d)).then((e=>{const n=e;(0,o.setDoc)((0,o.doc)(l,"pacienti",t),{nume:c,prenume:m,medic:n}).then((()=>{r.reset(),location.href="./patient_main.html"}))})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}))}))})).catch((function(e){console.error(e),alert("confirmarea nr a esuat"),location.reload()}))})):console.log("nu e bun")}))})();